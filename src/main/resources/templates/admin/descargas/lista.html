<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head><title>Descargas</title></head>
<body>
<div th:replace="~{layout/admin :: layout('Descargas','descargas', ~{::section})}"></div>

<section class="grid gap-6">
  <h1 class="text-2xl font-semibold">Descargas</h1>

  <div th:if="${ok}" class="p-3 rounded-xl border border-green-300 bg-green-50" th:text="${ok}"></div>
  <div th:if="${error}" class="p-3 rounded-xl border border-red-300 bg-red-50" th:text="${error}"></div>

  <div class="flex items-center gap-3">
    <form method="get" class="flex gap-2">
      <input class="border rounded p-2" type="text" name="q" placeholder="Buscar..." th:value="${q}"/>
      <button class="border rounded px-3 py-2">Buscar</button>
    </form>
    <a class="ml-auto border rounded px-3 py-2" href="/admin/descargas/new">Nueva</a>
  </div>

  <table class="w-full text-sm border rounded-xl overflow-hidden">
    <thead class="bg-slate-100">
      <tr>
        <th class="text-left p-2">ID</th>
        <th class="text-left p-2">Nombre</th>
        <th class="text-left p-2">Ruta</th>
        <th class="text-center p-2">Habilitado</th>
        <th class="text-right p-2">Descargas</th>
        <th class="p-2"></th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="d : ${lista}" class="border-t">
        <td class="p-2" th:text="${d.id}">1</td>
        <td class="p-2" th:text="${d.nombre}">Utilidad</td>
        <td class="p-2 break-all" th:text="${d.rutaArchivo}">/opt/...</td>
        <td class="p-2 text-center" th:text="${d.habilitado} ? 'Sí' : 'No'">Sí</td>
        <td class="p-2 text-right" th:text="${d.totalDescargas}">0</td>
        <td class="p-2 text-right">
          <a class="border rounded px-2 py-1" th:href="@{'/admin/descargas/' + ${d.id} + '/edit'}">Editar</a>
          <form th:action="@{'/admin/descargas/' + ${d.id} + '/delete'}" method="post" style="display:inline-block" onsubmit="return confirm('¿Eliminar?');">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button class="border rounded px-2 py-1">Borrar</button>
          </form>
        </td>
      </tr>
      <tr th:if="${#lists.isEmpty(lista)}"><td colspan="6" class="p-4 text-center text-slate-500">Sin elementos</td></tr>
    </tbody>
  </table>
</section>

</body>
</html>
